<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BudgetWise | Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <style>
        :root {
            --primary: #1e2a5a;
            --sidebar-bg: #25316d;
            --accent: #4361ee;
            --bg-color: #f4f6fb;
            --white: #ffffff;
        }

        body {
            margin: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-color);
            display: flex;
            flex-direction: column;
            height: 100vh;
        }

        /* HEADER */
        .header {
            background: var(--primary);
            color: white;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 10;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .header h2 { margin: 0; font-size: 20px; letter-spacing: 1px; }

        /* MAIN LAYOUT */
        .main {
            display: flex;
            flex: 1;
            overflow: hidden;
        }

        /* SIDEBAR */
        .sidebar {
            width: 260px;
            background: var(--sidebar-bg);
            color: white;
            display: flex;
            flex-direction: column;
            transition: all 0.3s;
        }
        .sidebar h3 {
            text-align: center;
            padding: 20px 0;
            margin: 0;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 2px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            color: #adb5bd;
        }
        .sidebar button {
            width: 100%;
            padding: 15px 25px;
            background: none;
            border: none;
            color: #dee2e6;
            text-align: left;
            cursor: pointer;
            font-size: 15px;
            transition: 0.3s;
            display: flex;
            align-items: center;
            gap: 12px;
        }
        .sidebar button:hover {
            background: rgba(255,255,255,0.1);
            color: white;
            padding-left: 30px;
        }

        /* CONTENT AREA */
        .content {
            padding: 30px;
            flex: 1;
            overflow-y: auto;
        }

        /* SUMMARY CARDS */
        .cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        .card {
            background: var(--white);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            border-left: 5px solid var(--primary);
        }
        .card h4 { margin: 0; color: #6c757d; font-size: 14px; text-transform: uppercase; }
        .card p { font-size: 28px; font-weight: bold; margin: 10px 0 0; }

        .income { color: #2e7d32; border-left-color: #2e7d32; }
        .expense { color: #c62828; border-left-color: #c62828; }
        .balance { color: var(--primary); border-left-color: var(--primary); }

        /* CHART OVERVIEW */
        .overview {
            background: var(--white);
            padding: 25px;
            border-radius: 15px;
            max-width: 550px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        }
        .overview h3 { margin-top: 0; margin-bottom: 20px; color: var(--primary); }

        canvas { max-width: 100%; height: auto !important; }

    </style>
</head>

<body>

<div class="header">
    <h2>BudgetWise</h2>
    <div style="font-size: 14px;">Welcome, User üëã</div>
</div>

<div class="main">
    <div class="sidebar">
        <h3>Menu</h3>
        <button onclick="go('dashboard.html')">üè† Dashboard</button>
        <button onclick="go('add-expense.html')">‚ûï Add Expense</button>
        <button onclick="go('view-expense.html')">üìÑ View Expense</button>
        <button onclick="go('budget-plan.html')">üìä Budget Plan</button>
        <button onclick="go('saving-goals.html')">üéØ Saving Goals</button>
        <button onclick="go('financialtrends-visualization.html')">üìà Financial Trends</button>
        <button onclick="go('data-export.html')">ü§ñ AI Advisor</button>
        <div style="margin-top: auto;">
            <button onclick="logout()" style="color: #ff7675;">üö™ Logout</button>
        </div>
    </div>

    <div class="content">
        <div class="cards">
            <div class="card income">
                <h4>Total Income</h4>
                <p>‚Çπ <span id="income">50000</span></p>
            </div>
            <div class="card expense">
                <h4>Total Expense</h4>
                <p>‚Çπ <span id="expense">0</span></p>
            </div>
            <div class="card balance">
                <h4>Balance</h4>
                <p>‚Çπ <span id="balance">0</span></p>
            </div>
        </div>

        <div class="overview">
            <h3>Expense Breakdown</h3>
            <canvas id="chart"></canvas>
        </div>
    </div>
</div>

<script>
    // 1. Initial Data Setup
    let income = 50000;

    // Default data if localStorage is empty
    let defaultExpenses = [
        {category:"Food", amount:8000},
        {category:"Transport", amount:4000},
        {category:"Shopping", amount:6000},
        {category:"Bills", amount:5000},
        {category:"Others", amount:2000}
    ];

    let expenses = JSON.parse(localStorage.getItem("expenses")) || defaultExpenses;

    // Save defaults to storage if it was empty
    if(!localStorage.getItem("expenses")) {
        localStorage.setItem("expenses", JSON.stringify(expenses));
    }

    // 2. Calculations
    let totalExpense = expenses.reduce((s, e) => s + Number(e.amount), 0);
    document.getElementById("expense").innerText = totalExpense.toLocaleString();
    document.getElementById("balance").innerText = (income - totalExpense).toLocaleString();

    // 3. Process Data for Chart
    let categoryData = {};
    expenses.forEach(e => {
        categoryData[e.category] = (categoryData[e.category] || 0) + Number(e.amount);
    });

    // 4. Initialize Pie Chart with Extended Colors
    const ctx = document.getElementById("chart").getContext('2d');
    new Chart(ctx, {
        type: 'pie',
        data: {
            labels: Object.keys(categoryData),
            datasets: [{
                data: Object.values(categoryData),
                backgroundColor: [
                    '#ff6384', // Food
                    '#36a2eb', // Transport
                    '#9966ff', // Shopping (New Purple)
                    '#ffce56', // Bills
                    '#4caf50', // Savings/Medical
                    '#ff9f40', // Others (New Orange)
                    '#00d2d3'  // Extra
                ],
                borderWidth: 2,
                borderColor: '#ffffff'
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: {
                    position: 'bottom',
                    labels: { padding: 20, usePointStyle: true }
                }
            }
        }
    });

    // Navigation Functions
    function go(page) { window.location.href = page; }
    function logout() { window.location.href = "index.html"; }
</script>

</body>
</html>